#!/bin/bash

PATH="$CROSSPI_TOOLCHAIN_DIR/usr/bin:$CROSSPI_HOST_DIR/bin:$CROSSPI_HOST_DIR/usr/bin:$CROSSPI_HOST_DIR/usr/local/bin:$PATH"
LD_LIBRARY_PATH="$CROSSPI_HOST_DIR/lib:$CROSSPI_HOST_DIR/usr/lib:$CROSSPI_HOST_DIR/usr/local/lib:$LD_LIBRARY_PATH"

/usr/bin/env \
	PATH=${PATH%:} \
	LD_LIBRARY_PATH=${LD_LIBRARY_PATH%:} \
	HOME=${CROSSPI_HOME}/home/${CROSSPI_SHELL} \
	\
	CPP=$CROSSPI_HOST-cpp \
	CC=$CROSSPI_HOST-gcc \
	CXX=$CROSSPI_HOST-g++ \
	AR=$CROSSPI_HOST-ar \
	RANLIB=$CROSSPI_HOST-ranlib \
	LD=$CROSSPI_HOST-ld \
	AS=$CROSSPI_HOST-as \
	NM=$CROSSPI_HOST-nm \
	LDD=$CROSSPI_HOST-ldd \
	STRIP=$CROSSPI_HOST-strip \
	LIBTOOL=$CROSSPI_HOST-libtool \
	LIBTOOLIZE=$CROSSPI_HOST-libtoolize \
	\
	PKG_CONFIG=$CROSSPI_HOST_DIR/usr/bin/pkg-config \
	PKG_CONFIG_DIR= \
	PKG_CONFIG_LIBDIR=$CROSSPI_TARGET_DIR/usr/lib/pkgconfig:$CROSSPI_TARGET_DIR/usr/share/pkgconfig \
	PKG_CONFIG_SYSROOT_DIR=$CROSSPI_TARGET_DIR \
	PKG_CONFIG_ALLOW_SYSTEM_CFLAGS=1 \
	PKG_CONFIG_ALLOW_SYSTEM_LIBS=1 \
	ACLOCAL_FLAGS="-I $CROSSPI_TARGET_DIR/usr/share/aclocal" \
	CPPFLAGS="-I$CROSSPI_TARGET_DIR/usr/include -I$CROSSPI_TARGET_DIR/usr/local/include -I$CROSSPI_TARGET_DIR/opt/vc/include -I$CROSSPI_TARGET_DIR/opt/vc/include/interface/vcos/pthreads" \
	LDFLAGS="-L$CROSSPI_TARGET_DIR/lib \
		-L$CROSSPI_TARGET_DIR/usr/lib \
		-L$CROSSPI_TARGET_DIR/usr/local/lib \
		-L$CROSSPI_TARGET_DIR/opt/vc/lib \
		-Wl,-rpath-link,$CROSSPI_TARGET_DIR/lib:$CROSSPI_TARGET_DIR/usr/lib:$CROSSPI_TARGET_DIR/usr/local/lib:$CROSSPI_TARGET_DIR/opt/vc/lib" \
	\
	HOST=$CROSSPI_HOST \
	TARGET=$CROSSPI_TARGET \
	CROSS_COMPILE=${CROSSPI_HOST}- \
	CROSS=${CROSSPI_HOST}- \
	DESTDIR=$CROSSPI_TARGET_DIR \
	\
	/bin/bash --noprofile --rcfile $CROSSPI_HOME/shells/$CROSSPI_SHELL/bashrc +h $@
